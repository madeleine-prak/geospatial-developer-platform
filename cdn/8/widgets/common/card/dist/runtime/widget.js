System.register(["jimu-core","jimu-ui","jimu-layouts/layout-runtime"],(function(e,t){var i={},o={},s={};return{setters:[function(e){i.AnimationContext=e.AnimationContext,i.AppMode=e.AppMode,i.Immutable=e.Immutable,i.LayoutItemType=e.LayoutItemType,i.LinkType=e.LinkType,i.React=e.React,i.ReactRedux=e.ReactRedux,i.ReactResizeDetector=e.ReactResizeDetector,i.TransitionContainer=e.TransitionContainer,i.TransitionDirection=e.TransitionDirection,i.TransitionType=e.TransitionType,i.appActions=e.appActions,i.classNames=e.classNames,i.css=e.css,i.defaultMessages=e.defaultMessages,i.getAppStore=e.getAppStore,i.getNextAnimationId=e.getNextAnimationId,i.jsx=e.jsx,i.lodash=e.lodash,i.polished=e.polished,i.utils=e.utils},function(e){o.WidgetPlaceholder=e.WidgetPlaceholder,o._Link=e._Link,o.styleUtils=e.styleUtils},function(e){s.LayoutEntry=e.LayoutEntry,s.LayoutItemSizeModes=e.LayoutItemSizeModes,s.searchUtils=e.searchUtils}],execute:function(){e((()=>{var e={90858:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#FFF" fill-rule="nonzero" d="M2 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm5-3a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2H7Zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4Zm0 7a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2H7Zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4Zm0 7a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2H7Zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4ZM2 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4Zm0 5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4Z"></path></svg>'},41235:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m2.116 1.5.969 1.678H1.05v3H0l1.5 2 1.5-2h-.951v-2h1.614l4.618 8H2.049v-2H1.05v3h7.809l1.257 2.178.866-.5L2.982 1l-.866.5Zm9.982 8.678h.95v2h-2.611l.576 1h3.036v-3h1.05l-1.501-2-1.5 2Zm.951-4v-2H5.817l-.578-1h8.81v3h-1Z" clip-rule="evenodd"></path></svg>'},60397:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1.049 6V3h13v3h-1V4h-11v2H3L1.5 7.999 0 6h1.049Zm12 4h-.952l1.5-2 1.5 2h-1.049v3H1.05v-3h1v2h11v-2Z" clip-rule="evenodd"></path></svg>'},48891:e=>{"use strict";e.exports=i},74758:e=>{"use strict";e.exports=s},30726:e=>{"use strict";e.exports=o}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="";var a={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(a),n.d(a,{Widget:()=>M,__set_webpack_public_path__:()=>R,default:()=>j});var e,t,i,o=n(48891),s=n(30726);o.TransitionType.None,o.TransitionDirection.Horizontal,function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3",e.Style4="STYLE4",e.Style5="STYLE5",e.Style6="STYLE6",e.Style7="STYLE7",e.Style8="STYLE8",e.Style9="STYLE9",e.Style10="STYLE10"}(e||(e={})),function(e){e.Regular="REGULAR",e.Hover="HOVER"}(t||(t={})),function(e){e.Horizontal="Horizontal",e.Vertical="Vertical"}(i||(i={}));var r=n(74758);class l extends o.React.PureComponent{constructor(){super(...arguments),this.formatMessage=(e,t)=>this.props.formatMessage(e,t),this.getStyle=e=>{const{widgetId:t}=this.props,i=this.checkIsBackgroundTransparent(e);return o.css`
      &,
      .animation-list {
        overflow: hidden;
      }
      .card-link {
        cursor: pointer;
      }
      ${"&.card-"+t} {
        padding: 0;
        border: 0;
        background-color: transparent;
        height: 100%;
        position: relative;
        .card-content {
          width: 100%;
          height: 100%;
          /* overflow: hidden; */
          & > div {
            width: 100%;
            height: 100%;
          }
        }
      }
      .edit-mask {
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        z-index: 10;
      }
      .clear-background {
        background: transparent !important;
      }
      .card-link {
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
      }
      .clear-background:focus {
        outline: none;
      }
      .surface-1 {
        border: none !important;
        background: ${i&&"none !important"};
      }
      .jimu-link {
        text-align: left;
      }
      ${"&.card-"+t}:hover {
      }
    `}}checkIsBackgroundTransparent(e){var t,i,o;const{cardConfigs:s}=this.props;return"rgba(0,0,0,0)"===(null===(o=null===(i=null===(t=null==s?void 0:s[e])||void 0===t?void 0:t.backgroundStyle)||void 0===i?void 0:i.background)||void 0===o?void 0:o.color)}}var d=n(60397),u=n.n(d);const c=e=>{const t=window.SVG,{className:i}=e,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(e,["className"]),n=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:n,src:u()},s)):o.React.createElement("svg",Object.assign({className:n},s))};var p=n(41235),h=n.n(p);const g=e=>{const t=window.SVG,{className:i}=e,s=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i}(e,["className"]),n=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:n,src:h()},s)):o.React.createElement("svg",Object.assign({className:n},s))},v=[0,5],y=[{name:"flip",options:{boundary:document.body,fallbackPlacements:["right-start","bottom-start","top-start","top-end"]}}],f=[{name:"offset",options:{offset:[0,10]}},{name:"arrow",enabled:!0}],m=o.ReactRedux.connect(((e,t)=>{var i;const{appMode:s}=t;return window.jimuConfig.isInBuilder&&s!==o.AppMode.Run?{selection:t.selectionIsInCard&&(null===(i=null==e?void 0:e.appRuntimeInfo)||void 0===i?void 0:i.selection)}:{selection:void 0}}))(class extends l{constructor(e){super(e),this.lastResizeCall=null,this.handleCopyTo=(e,t,i,s)=>{if(!i)return;const{layouts:n,builderSupportModules:a,browserSizeMode:l,builderStatus:d}=this.props,u=a.jimuForBuilderLib.getAppConfigAction(),c=u.appConfig,p=r.searchUtils.findLayoutId(n[d],l,c.mainSizeMode),h=r.searchUtils.findLayoutId(n[t],l,c.mainSizeMode);if(s){const e=a.widgetModules.searchUtils.getContainerLayoutItem(c.layouts[h],i.widgetId,o.LayoutItemType.Widget);e&&u.removeLayoutItem({layoutId:h,layoutItemId:e.id},!1)}u.duplicateLayoutItem(p,h,i.id,!1,s),this.setState({widgetsUpdate:Symbol()}),u.clearLayoutStructure(h,l,!0),u.buildLayoutStructure(h,l,!0),u.exec(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.editStatus=(e,t)=>{const{dispatch:i,widgetId:s}=this.props;i(o.appActions.widgetStatePropChange(s,e,t))},this.toggleStatus=e=>{var i;const{cardConfigs:s}=this.props,n=null===(i=null==s?void 0:s.HOVER)||void 0===i?void 0:i.enable,a=e===t.Hover;let{previousIndex:r,currentIndex:l,hoverPlayId:d,regularPlayId:u}=this.state;n&&(r=a?0:1,l=a?1:0,d=a?(0,o.getNextAnimationId)():null,u=a?null:(0,o.getNextAnimationId)()),this.setState({previousIndex:r,currentIndex:l,hoverPlayId:d,regularPlayId:u})},this.handleBreakLink=e=>{const{builderSupportModules:i,browserSizeMode:s,selection:n,builderStatus:a,dispatch:l,widgetId:d}=this.props,u=i.jimuForBuilderLib.getAppConfigAction(),c=u.appConfig,p=r.searchUtils.findLayoutItem(c,n);if(!p)return;const h=c.widgets[d].layouts[a][s];let g;u.duplicateLayoutItem(h,h,p.id,!0),g=a===t.Regular?c.widgets[d].layouts[t.Hover][s]:c.widgets[d].layouts[t.Regular][s],u.removeLayoutItem({layoutId:h,layoutItemId:p.id},!1),u.clearLayoutStructure(g,s,!0),u.buildLayoutStructure(g,s,!0),u.clearLayoutStructure(h,s,!0),u.buildLayoutStructure(h,s,!0),n.layoutId===h&&n.layoutItemId===p.id&&l(o.appActions.selectionChanged(null));const v=u.appConfig.layouts[h].content,y=Object.keys(v)[Object.keys(v).length-1];if(y){const e=v[y];l(o.appActions.selectionChanged({layoutId:h,layoutItemId:e.id}));const t=u.appConfig.widgets[e.widgetId],i=this.initParentOfNewWidgetAfterIsolate(t,h);u.editWidget(i).exec()}u.exec(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.initParentOfNewWidgetAfterIsolate=(e,t)=>{const{browserSizeMode:i}=this.props,o=e.parent[i],s=null==o?void 0:o.filter((e=>e.layoutId===t));return e.setIn(["parent",i],s)},this.getCopyDropdownItems=e=>{const{cardConfigs:i,layouts:s,browserSizeMode:n,selection:a,builderStatus:l,builderSupportModules:d}=this.props,u=d.jimuForBuilderLib.getAppConfigAction().appConfig,c=r.searchUtils.findLayoutItem(u,a);if(!a||!c||!window.jimuConfig.isInBuilder)return{items:(0,o.Immutable)([]),title:""};const p=[];let h="",g=!0,v=!0;const y=(e,t)=>d.widgetModules.searchUtils.getContentsInLayoutWithRecrusiveLayouts(u,e,o.LayoutItemType.Widget,n).indexOf(t)>-1;return l===t.Regular?((()=>{if(i[t.Hover]){const e=r.searchUtils.findLayoutId(s[t.Hover],n,u.mainSizeMode);y(e,u.layouts[a.layoutId].content[a.layoutItemId].widgetId)||(v=!1),p.push({label:this.formatMessage("applyTo",{status:this.formatMessage("hover").toLocaleLowerCase()}),event:e=>{this.handleCopyTo(e,t.Hover,c,v)}})}})(),h=this.formatMessage("linkedTo",{where:this.formatMessage("hover").toLocaleLowerCase()})):l===t.Hover&&((()=>{const e=r.searchUtils.findLayoutId(s[t.Regular],n,u.mainSizeMode);y(e,u.layouts[a.layoutId].content[a.layoutItemId].widgetId)||(g=!1),p.push({label:this.formatMessage("applyTo",{status:this.formatMessage("default").toLocaleLowerCase()}),event:e=>{this.handleCopyTo(e,t.Regular,c,g)}})})(),h=this.formatMessage("linkedTo",{where:this.formatMessage("default").toLocaleLowerCase()})),e?p.push({label:this.formatMessage("isolate"),event:this.handleBreakLink}):h=this.formatMessage("isolate"),{items:(0,o.Immutable)(p),title:h}},this.getCardToolsStyle=e=>o.css`
      width: 100%;
      .btn {
        width: 100%;
      }
      .dropdown-toggle {
        justify-content: center;
      }
    `,this.renderCardTools=()=>{if(!window.jimuConfig.isInBuilder)return;const{builderSupportModules:e,selectionIsCard:i,selectionIsInCard:s,appMode:n,hideCardTool:a,cardConfigs:r}=this.props,{BuilderPopper:l,GLOBAL_RESIZING_CLASS_NAME:d,GLOBAL_H5_DRAGGING_CLASS_NAME:u,GLOBAL_DRAGGING_CLASS_NAME:c}=e.widgetModules;let p=!0;return(!s&&!i||n===o.AppMode.Run||a)&&(p=!1),this.props.isEditing&&r[t.Hover].enable&&(0,o.jsx)(l,{placement:"left-start",trapFocus:!1,autoFocus:!1,css:o.css`
            .${c} &,
            .${d} &,
            .${u} & {
              &.popper {
                display: none;
              }
            }
          `,reference:this.layoutRef.current,offset:v,modifiers:y,open:p},this.getCardMenuElement())},this.getCardMenuElement=()=>{if(!window.jimuConfig.isInBuilder)return;const{selection:e,widgetId:i,builderSupportModules:s,browserSizeMode:n,builderStatus:a,selectionIsCard:r}=this.props,l=s.jimuForBuilderLib.getAppConfigAction().appConfig,{searchUtils:d,BuilderDropDown:u,BuilderButton:p,withBuilderTheme:h}=s.widgetModules,v=r,y=!v&&e&&d&&d.getRelatedLayoutItemsInWidgetByLayoutInfo(l,e,i,n).length>1,{items:m,title:I}=this.getCopyDropdownItems(y),S=m&&m.length>0,w=h((e=>(0,o.jsx)("div",{className:"status-group d-flex flex-column align-items-center p-2",css:this.getCardToolsStyle(e)},(0,o.jsx)(p,{active:a===t.Regular,onClick:e=>{this.handleBuilderStatusChange(e,t.Regular)}},this.formatMessage("default")),(0,o.jsx)(p,{active:a===t.Hover,className:"mt-1",onClick:e=>{this.handleBuilderStatusChange(e,t.Hover)}},this.formatMessage("hover")),!v&&(S||y)&&(0,o.jsx)(u,{className:"mt-1 w-100",toggleIsIcon:!0,toggleTitle:I,toggleType:"default",direction:"left",toggleContent:e=>y?(0,o.jsx)(c,{size:16}):(0,o.jsx)(g,{size:16}),modifiers:f,items:m}))));return(0,o.jsx)(w,null)},this.getEditorStyle=()=>o.css`
      &.card-content {
        .fixed-layout {
          border: 0 !important;
        }
      }
    `,this.renderCardEditor=()=>{const{cardConfigs:e,LayoutEntry:i,layouts:n,browserSizeMode:a}=this.props,{hoverPlayId:r,regularPlayId:l}=this.state,d=n[t.Regular],u=n[t.Hover],c=e[t.Regular].backgroundStyle.setIn(["boxShadow","color"],"transparent"),p=e[t.Hover].backgroundStyle.setIn(["boxShadow","color"],"transparent"),h=e.transitionInfo,g=[],v=Object.assign({},s.styleUtils.toCSSStyle(c||{})),y=(0,o.jsx)("div",{className:"card-content d-flex surface-1",css:this.getEditorStyle(),ref:this.regularLayoutRef,key:t.Regular},(0,o.jsx)("div",{className:"w-100, h-100 animation-list",style:v},(0,o.jsx)(o.AnimationContext.Provider,{value:{setting:(null==h?void 0:h.oneByOneEffect)||null,playId:l,oid:d[a]}},(0,o.jsx)(i,{className:"h-100",isRepeat:!0,layouts:d,isInWidget:!0}))));if(g.push(y),!e[t.Hover].enable)return g;const f=Object.assign({},s.styleUtils.toCSSStyle(p||{})),m=(0,o.jsx)("div",{className:"card-content d-flex surface-1",css:this.getEditorStyle(),ref:this.hoverLayoutRef,key:t.Hover},(0,o.jsx)("div",{className:"w-100, h-100 animation-list",style:f},(0,o.jsx)(o.AnimationContext.Provider,{value:{setting:(null==h?void 0:h.oneByOneEffect)||null,playId:r,oid:null==u?void 0:u[a]}},(0,o.jsx)(i,{className:"h-100",isRepeat:!0,layouts:u,isInWidget:!0}))));return g.push(m),g},this.getCardStyle=()=>{var e,i,o,n;const{builderStatus:a,cardConfigs:r}=this.props,l=r[t.Hover].enable?a:t.Regular,d={boxShadow:null===(i=null===(e=r[l])||void 0===e?void 0:e.backgroundStyle)||void 0===i?void 0:i.boxShadow,borderRadius:null===(n=null===(o=r[l])||void 0===o?void 0:o.backgroundStyle)||void 0===n?void 0:n.borderRadius};return Object.assign({},s.styleUtils.toCSSStyle(d))},this.state={didMount:!1,previousIndex:1,currentIndex:0,regularPlayId:null,hoverPlayId:null,widgetsUpdate:null},this.regularLayoutRef=o.React.createRef(),this.hoverLayoutRef=o.React.createRef(),this.layoutRef=o.React.createRef(),this.isUpdateFirst=!0}componentDidMount(){this.setState({didMount:!0})}componentDidUpdate(e){var i,o;const{cardConfigs:s,builderStatus:n}=this.props,a=e.cardConfigs,r=(null===(i=null==a?void 0:a.transitionInfo)||void 0===i?void 0:i.previewId)===(null===(o=null==s?void 0:s.transitionInfo)||void 0===o?void 0:o.previewId),l=e.builderStatus&&e.builderStatus!==n&&!this.isUpdateFirst,d=a[t.Hover].enable!==s[t.Hover].enable;(!r||l||d)&&this.toggleStatus(n),this.isUpdateFirst&&(this.isUpdateFirst=!1)}handleBuilderStatusChange(e,t){var i;this.editStatus("showCardSetting",t),this.editStatus("builderStatus",t),null===(i=null==this?void 0:this.props)||void 0===i||i.selectSelf(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}render(){var e,t;const{cardConfigs:i,widgetId:s,isShowMask:n,builderStatus:a,selectionIsCard:r,selectionIsInCard:l}=this.props,{didMount:d,previousIndex:u,currentIndex:c}=this.state,p=i.transitionInfo,h=`card-${s}`,g=(r||l?null==p?void 0:p.previewId:null)||null;return(0,o.jsx)("div",{css:this.getStyle(a),style:this.getCardStyle(),className:h},d&&this.renderCardTools(),(0,o.jsx)("div",{className:"w-100, h-100",ref:this.layoutRef},(0,o.jsx)(o.TransitionContainer,{previousIndex:u,currentIndex:c,transitionType:null===(e=null==p?void 0:p.transition)||void 0===e?void 0:e.type,direction:null===(t=null==p?void 0:p.transition)||void 0===t?void 0:t.direction,playId:d?g:null,withOneByOne:!!(null==p?void 0:p.oneByOneEffect)},this.renderCardEditor())),n&&(0,o.jsx)("div",{className:"edit-mask position-absolute"}))}}),{useState:I,useRef:S,useEffect:w}=o.React,b=function(e){var i,n;const a=S(null),l=S(!1),{cardConfigs:d,layouts:u,appMode:c,linkParam:p,browserSizeMode:h,hoverPlayId:g,regularPlayId:v,previewId:y,previousIndex:f,currentIndex:m}=e;let{queryObject:b}=e;const[C,x]=I(null),[M,j]=I(!1),[R,L]=I(!1);w((()=>{var e,t;x(null==d?void 0:d.transitionInfo),j(null===(e=null==d?void 0:d.HOVER)||void 0===e?void 0:e.enable),L((null===(t=window.jimuConfig)||void 0===t?void 0:t.isInBuilder)||!1)}),[d]),w((()=>{l.current=!0}),[]);const T=e=>{const t=d[e].backgroundStyle;return(null==t?void 0:t.boxShadow)?t.setIn(["boxShadow","color"],"transparent"):t};return(0,o.jsx)("div",{onClick:e=>{var t;const i=e.target&&e.target.tagName||"";"a"!==i.toLowerCase()&&"button"!==i.toLowerCase()&&"linkClick"!==e.exbEventType&&a.current&&(null===(t=a.current)||void 0===t||t.click()),"linkClick"===e.exbEventType&&delete e.exbEventType}},(0,o.jsx)(o.TransitionContainer,{previousIndex:f,currentIndex:m,transitionType:null===(i=null==C?void 0:C.transition)||void 0===i?void 0:i.type,direction:null===(n=null==C?void 0:C.transition)||void 0===n?void 0:n.direction,playId:l.current?y:null,withOneByOne:!!(null==C?void 0:C.oneByOneEffect)},(()=>{const e=[];let i,n,l,d,y,f;R&&c!==o.AppMode.Run?(n=T(t.Regular),i=u[t.Regular],M&&(d=T(t.Hover),l=u[t.Hover])):(i=u[t.Regular],n=T(t.Regular),p&&p.linkType&&(y=p.openType,f={linkType:p.linkType},p.linkType===o.LinkType.WebAddress?(f.value=(null==p?void 0:p.value)||"",b=void 0):f.value=p.value),M&&(l=u[t.Hover],d=T(t.Hover)));const m=Object.assign({},s.styleUtils.toCSSStyle(n||{})),I=(null==p?void 0:p.linkType)&&(null==p?void 0:p.linkType)!==o.LinkType.None,S=(0,o.jsx)("div",{className:(0,o.classNames)("card-content d-flex surface-1",I?"card-link":""),key:t.Regular},(0,o.jsx)("div",{className:"w-100 animation-list",style:m},(0,o.jsx)(s._Link,{className:"p-0 w-100 h-100 border-0 clear-background card-link",ref:a,to:f,target:y,queryObject:b}),(0,o.jsx)("div",{className:"d-flex w-100 h-100"},(0,o.jsx)(o.AnimationContext.Provider,{value:{setting:(null==C?void 0:C.oneByOneEffect)||null,playId:v,oid:null==i?void 0:i[h]}},(0,o.jsx)(r.LayoutEntry,{layouts:i})))));if(e.push(S),M){const i=Object.assign({},s.styleUtils.toCSSStyle(d||{})),n=(0,o.jsx)("div",{className:(0,o.classNames)("card-content d-flex surface-1 w-100 h-100",I?"card-link":""),key:t.Hover},(0,o.jsx)("div",{className:"w-100 h-100 animation-list",style:i},(0,o.jsx)(s._Link,{className:"p-0 w-100 h-100 border-0 clear-background card-link",ref:a,to:f,target:y,queryObject:b}),(0,o.jsx)("div",{className:"d-flex w-100 h-100"},(0,o.jsx)(o.AnimationContext.Provider,{value:{setting:(null==C?void 0:C.oneByOneEffect)||null,playId:g,oid:l[h]}},(0,o.jsx)(r.LayoutEntry,{layouts:l})))));e.push(n)}return e})()))};class C extends l{constructor(e){super(e),this.onMouse=(e,t=!1)=>{var i;const{cardConfigs:s}=this.props,n=null===(i=null==s?void 0:s.HOVER)||void 0===i?void 0:i.enable;let{previousIndex:a,currentIndex:r,hoverPlayId:l,regularPlayId:d}=this.state;n&&(a=t?0:1,r=t?1:0,l=t?(0,o.getNextAnimationId)():null,d=t?null:(0,o.getNextAnimationId)()),this.setState({isHover:t,previousIndex:a,currentIndex:r,hoverPlayId:l,regularPlayId:d})},this.getCardShadowStyle=()=>{var e,i;const{cardConfigs:o}=this.props,{isHover:n}=this.state,a=n&&o[t.Hover].enable?t.Hover:t.Regular,r={boxShadow:null===(e=o[a].backgroundStyle)||void 0===e?void 0:e.boxShadow,borderRadius:null===(i=o[a].backgroundStyle)||void 0===i?void 0:i.borderRadius};return Object.assign({},s.styleUtils.toCSSStyle(r))},this.state={url:"",isHover:!1,previousIndex:1,currentIndex:0,regularPlayId:null,hoverPlayId:null},this.regularLayoutRef=o.React.createRef(),this.hoverLayoutRef=o.React.createRef(),this.linkRef=o.React.createRef(),this.didMount=!1}componentDidMount(){this.didMount=!0}componentDidUpdate(e){var t,i;const s=this.props.cardConfigs,{cardConfigs:n}=e;(null===(t=null==s?void 0:s.transitionInfo)||void 0===t?void 0:t.previewId)===(null===(i=null==n?void 0:n.transitionInfo)||void 0===i?void 0:i.previewId)||this.setState({hoverPlayId:(0,o.getNextAnimationId)(),regularPlayId:(0,o.getNextAnimationId)()})}render(){const{widgetId:e,cardConfigs:i,linkParam:s,queryObject:n,layouts:a,appMode:r,browserSizeMode:l}=this.props,{previousIndex:d,currentIndex:u,regularPlayId:c,hoverPlayId:p}=this.state,h=i.transitionInfo,g=`card-${e}`,v=(null==h?void 0:h.previewId)||null,y=0===u?t.Regular:t.Hover;return(0,o.jsx)("div",{css:this.getStyle(y),style:this.getCardShadowStyle(),className:g,onMouseLeave:e=>{this.onMouse(e,!1)},onMouseEnter:e=>{this.onMouse(e,!0)}},(0,o.jsx)(b,{linkParam:s,queryObject:n,cardConfigs:i,layouts:a,appMode:r,browserSizeMode:l,hoverPlayId:p,regularPlayId:c,previousIndex:d,currentIndex:u,previewId:v}))}}const x={_layout_REGULAR_label:"Regular",_layout_HOVER_label:"Hover",applyTo:"Apply to {status}",isolate:"Isolate",linkedToAnd:"Linked to {where1} and {where2}",linkedTo:"Linked to {where}",placeHolderTip:"Please select a card template.",showSelected:"Show selection",_widgetLabel:"Card"};class M extends o.React.PureComponent{constructor(e){super(e),this.setListParentSizeInWidgetState=()=>{const{browserSizeMode:e,id:t,parentSize:i,layoutId:s}=this.props,n=(0,o.getAppStore)().getState().appConfig,a=o.utils.findViewportSize(n,e),r=`div.layout[data-layoutid=${s}]`,l=document.querySelector(r),d={width:(null==l?void 0:l.clientWidth)||a.width,height:(null==l?void 0:l.clientHeight)||a.height};i&&i.height===d.height&&i.width===d.width||this.props.dispatch(o.appActions.widgetStatePropChange(t,"parentSize",d))},this.setSelectionStatus=()=>{const{id:e,selectionIsInSelf:t}=this.props;this.props.dispatch(o.appActions.widgetStatePropChange(e,"selectionIsInSelf",t))},this.setSettinglayout=()=>{const{layoutId:e,layoutItemId:t,id:i,selectionIsSelf:s}=this.props,{isSetlayout:n}=this.state;e&&i&&t&&!n&&s&&(this.props.dispatch(o.appActions.widgetStatePropChange(i,"layoutInfo",{layoutId:e,layoutItemId:t})),this.setState({isSetlayout:!0}))},this.onResize=(e,t)=>{this.updateCardToolPosition()},this.updateCardToolPosition=()=>{const{selectionIsSelf:e}=this.props;e&&(this.setState({hideCardTool:!0}),this.updateCardToolTimeout&&(clearTimeout(this.updateCardToolTimeout),this.updateCardToolTimeout=void 0),this.updateCardToolTimeout=setTimeout((()=>{this.setState({hideCardTool:!1})}),500))},this.formatMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:Object.assign(Object.assign({},x),o.defaultMessages)[e]},t),this.editStatus=(e,t)=>{const{dispatch:i,id:s}=this.props;i(o.appActions.widgetStatePropChange(s,e,t))},this.editWidgetConfig=e=>{window.jimuConfig.isInBuilder&&this.props.builderSupportModules.jimuForBuilderLib.getAppConfigAction().editWidgetConfig(this.props.id,e).exec()},this.isEditing=()=>{const{appMode:e,config:t,selectionIsSelf:i,selectionIsInSelf:s}=this.props;return!!window.jimuConfig.isInBuilder&&(i||s)&&window.jimuConfig.isInBuilder&&e!==o.AppMode.Run&&t.isItemStyleConfirm},this.checkIsShowMask=()=>{const{appMode:e,config:t}=this.props;return!(!window.jimuConfig.isInBuilder||window.jimuConfig.isInBuilder&&e!==o.AppMode.Run&&t.isItemStyleConfirm)},this.editBuilderAndSettingStatus=e=>{this.editStatus("showCardSetting",e),this.editStatus("builderStatus",e)},this.getAppConfig=()=>(0,o.getAppStore)().getState().appConfig,this.getStyle=e=>{const{id:t}=this.props;return o.css`
      ${"&.card-widget-"+t} {
        overflow: visible;
        background-color: transparent;
        border: ${o.polished.rem(0)} solid
          ${o.polished.rgba(e.colors.black,window.jimuConfig.isInBuilder&&this.isEditing()?.2:0)};
        width: 100%;
        height: 100%;
      }
    `},this.getCardProps=()=>{const{config:e,selectionIsInSelf:t,selectionIsSelf:i,builderStatus:s,appMode:n,queryObject:a}=this.props,r=window.jimuConfig.isInBuilder&&n===o.AppMode.Design?{hideCardTool:this.state.hideCardTool,selectionIsCard:i,selectionIsInCard:t,isEditing:this.isEditing(),isShowMask:this.checkIsShowMask(),builderStatus:s,selectSelf:this.selectSelf}:{linkParam:e.linkParam,queryObject:a};return Object.assign(Object.assign({},this.getOtherProps()),r)},this.getOtherProps=()=>{const{config:e,theme:t,id:i,appMode:o,builderSupportModules:s,layouts:n,browserSizeMode:a,dispatch:r,isRTL:l,isHeightAuto:d,isWidthAuto:u}=this.props;return{browserSizeMode:a,isRTL:l,builderSupportModules:s,formatMessage:this.formatMessage,dispatch:r,widgetId:i,interact:window.jimuConfig.isInBuilder&&s.widgetModules.interact,appMode:o,theme:t,LayoutEntry:this.state.LayoutEntry,layouts:n,cardConfigs:e,isHeightAuto:d,isWidthAuto:u}},this.cardRender=()=>{const e=this.getCardProps(),{appMode:t}=this.props,i=window.jimuConfig.isInBuilder&&t===o.AppMode.Design?m:C;return(0,o.jsx)(i,Object.assign({},e))};const t={LayoutEntry:null,hideCardTool:!1,isSetlayout:!1};window.jimuConfig.isInBuilder?t.LayoutEntry=this.props.builderSupportModules.LayoutEntry:t.LayoutEntry=r.LayoutEntry,this.state=t,this.onResize=this.onResize.bind(this),this.selectSelf=this.selectSelf.bind(this),this.debounceOnResize=o.lodash.debounce(((e,t)=>{this.onResize(e,t)}),200)}componentDidUpdate(e,i){var s;const{appMode:n,selectionStatus:a,builderStatus:r,left:l,top:d}=this.props;n!==o.AppMode.Run&&a!==r&&a&&this.editBuilderAndSettingStatus(a),e.appMode!==n&&n===o.AppMode.Run&&this.editBuilderAndSettingStatus(t.Regular),(null==e?void 0:e.selectionIsInSelf)!==(null===(s=this.props)||void 0===s?void 0:s.selectionIsInSelf)&&this.setSelectionStatus(),d===e.top&&l===e.left||this.updateCardToolPosition(),this.setSettinglayout(),this.setListParentSizeInWidgetState()}selectSelf(){if(!window.jimuConfig.isInBuilder)return!1;const{layoutId:e,layoutItemId:t}=this.props,i={layoutId:e,layoutItemId:t};this.props.dispatch(o.appActions.selectionChanged(i))}render(){const{config:e,id:t}=this.props,i=(0,o.classNames)("jimu-widget","widget-card","card-widget-"+t);return e.itemStyle?(0,o.jsx)("div",{className:i,css:this.getStyle(this.props.theme)},this.cardRender(),(0,o.jsx)(o.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:this.debounceOnResize})):(0,o.jsx)(s.WidgetPlaceholder,{widgetId:this.props.id,icon:n(90858),message:this.formatMessage("placeHolderTip")})}}M.mapExtraStateProps=(e,i)=>{var o,s,n,a,l,d,u,c,p,h,g,v,y,f,m;const I=e&&e.appConfig,{layouts:S,layoutId:w,layoutItemId:b,builderSupportModules:C,id:x}=i,M=null==e?void 0:e.browserSizeMode,j=(null==e?void 0:e.widgetsState[i.id])&&(null===(o=null==e?void 0:e.widgetsState[i.id])||void 0===o?void 0:o.builderStatus)||t.Regular,R=e&&e.appRuntimeInfo&&e.appRuntimeInfo.selection,L=R&&C&&C.widgetModules&&C.widgetModules.selectionInCard(R,x,I,!1);let T;L&&(T=Object.keys(S).find((e=>r.searchUtils.findLayoutId(S[e],M,I.mainSizeMode)===R.layoutId)));const k=null===(s=I.layouts)||void 0===s?void 0:s[w],A=null===(a=null===(n=null==k?void 0:k.content)||void 0===n?void 0:n[b])||void 0===a?void 0:a.setting,P=(null===(l=null==A?void 0:A.autoProps)||void 0===l?void 0:l.height)===r.LayoutItemSizeModes.Auto||!0===(null===(d=null==A?void 0:A.autoProps)||void 0===d?void 0:d.height),O=(null===(u=null==A?void 0:A.autoProps)||void 0===u?void 0:u.width)===r.LayoutItemSizeModes.Auto||!0===(null===(c=null==A?void 0:A.autoProps)||void 0===c?void 0:c.width);let E;if(window.jimuConfig.isInBuilder){const e=null===(v=null===(g=null===(h=null===(p=I.layouts)||void 0===p?void 0:p[w])||void 0===h?void 0:h.content)||void 0===g?void 0:g[b])||void 0===v?void 0:v.bbox;E=e&&{left:e.left,top:e.top}}return{selectionIsSelf:(null==R?void 0:R.layoutId)===w&&(null==R?void 0:R.layoutItemId)===b,selectionIsInSelf:L,selectionStatus:T,appMode:null===(y=null==e?void 0:e.appRuntimeInfo)||void 0===y?void 0:y.appMode,browserSizeMode:null==e?void 0:e.browserSizeMode,builderStatus:j,isRTL:null===(f=null==e?void 0:e.appContext)||void 0===f?void 0:f.isRTL,left:E&&E.left,top:E&&E.top,isHeightAuto:P,isWidthAuto:O,queryObject:e.queryObject,parentSize:(null===(m=e.widgetsState[i.id])||void 0===m?void 0:m.parentSize)||null}};const j=M;function R(e){n.p=e}})(),a})())}}}));